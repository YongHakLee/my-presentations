<!doctype html>
<html lang="ko">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>2025-09-17 Lab Meeting: Camera Matrix</title>

    <!-- reveal.js의 핵심 CSS 파일들을 지정된 경로에서 가져온다. -->
    <link rel="stylesheet" href="../../reveal.js/dist/reset.css">
    <link rel="stylesheet" href="../../reveal.js/dist/reveal.css">
    <!-- 프레젠테이션 테마 (white, black, league, sky, beige, simple 등) -->
    <link rel="stylesheet" href="../../reveal.js/dist/theme/black-contrast.css" id="theme">

    <!-- 코드 구문 강조(Highlighting)를 위한 테마 -->
    <link rel="stylesheet" href="../../reveal.js/plugin/highlight/monokai.css">

    <style>
        /* 좌/우 2단 레이아웃을 위한 기본 스타일 */
        .two-column {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .two-column > div {
            flex-basis: 48%; /* 기본 50:50 비율 */
        }
        .two-column p, .two-column ul {
            text-align: left;
        }

        /* 이미지를 크게 만드는 레이아웃 클래스 */
        .layout-text-small .text-block {
            flex-basis: 30%; /* 글자 영역은 30% */
        }

        .layout-text-small .image-block {
            flex-basis: 68%; /* 이미지 영역은 68% */
        }

        /* 이미지 블록 안의 이미지가 부모 너비에 꽉 차도록 설정 */
        .image-block img {
            width: 100%;
            height: auto; /* 가로세로 비율 유지 */
        }

        /* 텍스트 블록 안의 글자 크기 조정 */
        .text-block h3 {
            font-size: 1.2em; /* 제목 크기 약간 줄이기 */
        }
        .text-block p, .text-block ul {
            font-size: 0.7em; /* 본문 텍스트 크기 줄이기 */
            line-height: 1.4; /* 줄 간격도 살짝 조정 */
        }
        
        /* Intrinsic/Extrinsic 비교를 위한 그리드 레이아웃 */
        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: auto auto 1fr;
            gap: 0 20px;
            align-items: start;
            text-align: center;
            height: 100%;
        }
        .comparison-grid h4 {
            grid-column: span 1;
        }
        .comparison-grid p {
             grid-column: span 1;
             font-size: 0.8em;
             margin-top: -20px;
        }
        .comparison-grid .formula {
            grid-column: span 1;
            align-self: center;
        }

    </style>
</head>
<body>
    <div class="reveal">
        <div class="slides">

            <section>
                <h2>2025-09-17 Lab Meeting</h2>
                <h1>Topic: Camera Matrix</h1>
            </section>

            <section>
                <h2>Introduction</h2>
                <p>카메라 행렬(Camera Matrix)은 월드 공간(World Space)의 한 점이 어떻게 이미지에 매핑되는지를 알려준다.</p>
                <p>카메라 행렬은 <strong>Intrinsic Matrix</strong>와 <strong>Extrinsic Matrix</strong>로 나뉜다.</p>
            </section>

            <section>
                <div class="comparison-grid">
                    <h4>INTRINSIC MATRIX</h4>
                    <h4>EXTRINSIC MATRIX</h4>
                    <p>카메라의 내부 파라미터를 포함.</p>
                    <p>카메라의 외부 파라미터를 포함.</p>
                    <div class="formula">
                         \[
                        K = \begin{bmatrix}
                        f_x & 0 & c_x \\
                        0 & f_y & c_y \\
                        0 & 0 & 1
                        \end{bmatrix}
                        \]
                    </div>
                    <div class="formula">
                        \[
                        R, T = \begin{bmatrix}
                        r_{11} & r_{12} & r_{13} \\
                        \vdots & \ddots & \vdots
                        \end{bmatrix},
                        \begin{bmatrix}
                        t_x \\ t_y \\ t_z
                        \end{bmatrix}
                        \]
                    </div>
                </div>
            </section>
            
            <section>
                <h2>핀홀 카메라 (Pinhole Camera)</h2>
                <div class="two-column layout-text-small">
                    <div class="text-block">
                        <h3>핀홀 카메라란?</h3>
                        <p>실제 카메라는 분석이 복잡해서, <strong>핀홀 카메라</strong>라는 단순화된 모델을 사용한다.</p>
                        <p>이상적인 핀홀 카메라는 무한히 작은 조리개(점)를 가지며, 그 결과 센서의 각 점에는 단 하나의 방향에서 오는 빛만 도달하게 된다.</p>
                    </div>
                    <div class="image-block">
                        <img data-src="./imgs/pinhole_camera.png" alt="핀홀 카메라">
                    </div>
                </div>
            </section>

            <section>
                <h3>핀홀 카메라 모델의 한계</h3>
                <p>실제 카메라는 렌즈를 사용하여 이미지를 선명하게 만들지만, 이로 인해 왜곡(Distortion)이 발생한다.</p>
                <ul>
                    <li><strong>방사 왜곡 (Radial Distortion)</strong>: 렌즈 중심에서 멀어질수록 이미지가 볼록/오목해지는 현상.</li>
                    <li><strong>접선 왜곡 (Tangential Distortion)</strong>: 렌즈와 센서가 평행하지 않아 이미지가 기울어 보이는 현상.</li>
                </ul>
                <p>하지만 좋은 카메라에서는 오차가 작아, 핀홀 모델은 간단하고 매우 유용한 모델이다.</p>
            </section>
            
            <section>
                <h2>월드와 카메라 좌표계</h2>
                <div class="two-column layout-text-small">
                    <div class="text-block">
                        <h3>좌표계 설정</h3>
                        <p>일반적으로 월드 좌표계는 z축이 위를 향하지만, 카메라 작업 시에는 카메라가 양의 z축 방향을 바라보는 좌표계를 사용하는 것이 편리하다.</p>
                        <p>z축은 <strong>광축(Optical Axis)</strong>이라고도 불린다.</p>
                    </div>
                    <div class="image-block">
                        <img data-src="./imgs/camera_coordinate.png" alt="카메라 좌표계">
                    </div>
                </div>
            </section>

            <section>
                <h2>내부 파라미터 행렬 (Intrinsic Matrix)</h2>
                <div class="two-column layout-text-small">
                     <div class="text-block">
                        <h3>기본 구성</h3>
                        <p>핀홀 조리개를 카메라 좌표계 원점에, 이미지 평면(센서)을 조리개 뒤에 놓는다.</p>
                        <p>광축인 z축은 이미지 평면의 중심을 통과한다. 앞으로 대문자는 mm, 소문자는 pixel 단위를 의미한다.</p>
                    </div>
                    <div class="image-block">
                        <img data-src="./imgs/sensor_aperture.png" alt="센서와 조리개">
                    </div>
                </div>
            </section>
            
            <section>
                <h3>초점 거리와 화각</h3>
                <div class="two-column layout-text-small">
                    <div class="text-block">
                        <h3>관계</h3>
                        <p>이미지 평면과 조리개 사이의 거리는 <strong>초점 거리(Focal Length, F)</strong>다.</p>
                        <p>포착 가능한 양 극단 광선 사이의 각도는 <strong>화각(Angle of View)</strong>이다.</p>
                    </div>
                    <div class="image-block">
                        <img data-src="./imgs/angle_of_view.png" alt="수평 화각">
                    </div>
                </div>
            </section>

            <section>
                <h3>투영 관계 (Projection)</h3>
                <div class="two-column layout-text-small">
                    <div class="text-block">
                        <h3>닮은 삼각형</h3>
                        <p>점 ($X^C, Z^C$)에서 온 광선이 조리개를 통과하여 센서에 닿으면, 이미지 상의 점은 -U가 된다.</p>
                        <p>닮은 삼각형의 원리를 통해 다음 식을 유도할 수 있다.</p>
                        \[ \frac{-U}{-F} = \frac{X^C}{Z^C} \]
                    </div>
                    <div class="image-block">
                         <img data-src="./imgs/two_objects.png" alt="물체들">
                    </div>
                </div>
            </section>

            <!-- [수정된 슬라이드] -->
            <section>
                <h3>단위 변환 및 오프셋</h3>
                <div class="two-column layout-text-small">
                    <div class="text-block">
                        <h4>mm to pixel</h4>
                        <p style="font-size: 0.5em;">초점 거리(F)와 이미지 크기(U)의 절대값보다 상대적 비율이 중요하므로, 단위 변환을 위한 계수 k를 도입할 수 있다.</p>
                            \[ \frac{-kU}{-kF} = \frac{X^C}{Z^C} \]
                        <p style="font-size: 0.5em;">k는 mm를 pixel로 바꾸는 역할을 하며(k=w/W), 이를 통해 초점 거리($f_x$)와 이미지 좌표(u)를 픽셀 단위로 표현한다.</p>
                        <p style="font-size: 0.5em;">여기에 센서 오프셋($u_0$)을 추가로 고려하면, 최종 수식은 다음과 같이 정리된다.</p>
                    </div>
                     <div class="image-block">
                        <img data-src="./imgs/pixelwithk.png" alt="k적용">
                        \[ \frac{-u'+u_0}{-f_x} = \frac{X^C}{Z^C} \]
                    </div>
                </div>
            </section>

            <section>
                <h3>최종 내부 파라미터 수식</h3>
                <p>최종 관계식은 다음과 같다.</p>
                \[ uZ^{C} = f_{x}X^{C} + u_{0}Z^{C} \]
                \[ vZ^{C} = f_{y}Y^{C} + v_{0}Z^{C} \]
                <p>이것을 행렬로 표현하면,</p>
                \[
                \begin{bmatrix}
                Z^Cu \\
                Z^Cv 
                \end{bmatrix}=
                \begin{bmatrix}
                f_x & 0 & u_0 \\
                0 & f_y & v_0 
                \end{bmatrix}
                \begin{bmatrix}
                X^C \\
                Y^C \\
                Z^C
                \end{bmatrix}
                \]
            </section>
            
            <section>
                <h2>동차 좌표계 (Homogeneous)</h2>
                <p>데카르트 좌표 [x, y]는 동차 좌표 (xS, yS, S)에 해당한다.</p>
                <div style="display: flex; justify-content: space-around;">
                    <img data-src="./imgs/homogeneous_1.png" alt="동차 좌표계1" style="max-height: 400px;">
                    <img data-src="./imgs/homogeneous_2.png" alt="동차 좌표계2" style="max-height: 400px;">
                </div>
            </section>
            
            <section>
                <h3>동차 좌표계의 장점</h3>
                <div class="two-column layout-text-small">
                    <div class="text-block">
                        <h3>장점</h3>
                        <p>데카르트 좌표계에서는 회전과 이동이 별개의 연산이지만, 동차 좌표계에서는 이 두 연산을 하나의 행렬 곱셈으로 통합할 수 있다.</p>
                    </div>
                    <div class="image-block">
                        <img data-src="./imgs/homogeneous_3.png" alt="동차 좌표계3">
                    </div>
                </div>
            </section>

            <section>
                <h3>Intrinsic Matrix (동차 좌표계)</h3>
                <p>동차 좌표계를 활용하여 내부 파라미터 행렬을 3x3 행렬로 확장할 수 있다.</p>
                \[
                \begin{bmatrix}
                f_x & 0 & u_0 \\
                0 & f_y & v_0 \\
                0 & 0 & 1
                \end{bmatrix}
                \begin{bmatrix}
                X^C \\
                Y^C \\
                Z^C
                \end{bmatrix}=
                \begin{bmatrix}
                Z^Cu \\
                Z^Cv \\
                Z^C
                \end{bmatrix}
                \]
            </section>
            
            <section>
                <h2>외부 파라미터 행렬 (Extrinsic Matrix)</h2>
                <p>객체 좌표를 월드 좌표계(World)에서 카메라 좌표계(Camera)로 변환하는 역할을 한다.</p>
                 \[
                \begin{bmatrix}
                X^C \\
                Y^C \\
                Z^C 
                \end{bmatrix}
                =
                \begin{bmatrix}
                r_{11} & r_{12} & r_{13} & t_x \\
                r_{21} & r_{22} & r_{23} & t_y \\
                r_{31} & r_{32} & r_{33} & t_z 
                \end{bmatrix}
                \begin{bmatrix}
                X^W \\
                Y^W \\
                Z^W \\
                1
                \end{bmatrix}
                \]
            </section>
            
            <section>
                <h4>좌표 변환 (Coordinate Transformations)</h4>
                <div class="two-column layout-text-small">
                    <div class="text-block">
                        <h3>변환 관계</h3>
                        <p><strong>좌표계를 변환</strong>하는 것은 <strong>객체의 좌표를 역방향으로 변환</strong>하는 것과 같다.</p>
                        <p>즉, Camera-to-World 행렬의 역행렬이 World-to-Camera 행렬이다.</p>
                    </div>
                    <div class="image-block">
                         <img data-src="./imgs/camera_and_world_coord.png" alt="카메라와 월드좌표계">
                    </div>
                </div>
            </section>
            
            <section>
                <div class="two-column layout-text-small">
                    <div class="text-block">
                        <h3>Extrinsic Matrix 예시</h3>
                        <p>월드 좌표계에서 카메라 좌표계로 가기 위해, 월드 축을 중심으로 회전(Rotation)하고 이동(Translation)시킨다.</p>
                        <p>이 변환 정보를 통해 Camera-to-World 행렬을 만들 수 있다.</p>
                    </div>
                    <div class="image-block">
                         <img data-src="./imgs/real_example.png" alt="전체 예시" style="height: 500px;">
                    </div>
                </div>
            </section>

            <section>
                <h3>Camera-to-World Matrix</h3>
                <p>카메라 좌표를 월드 좌표로 매핑하는 행렬이다. 카메라의 위치와 방향(회전)으로 정의된다.</p>
                <img data-src="./imgs/camera_to_world.png" alt="camera_to_world_matrix" class="r-stretch">
            </section>

            <section>
                <h3>World-to-Camera Matrix</h3>
                <p>우리가 필요한 것은 World-to-Camera 행렬이며, 이것은 Camera-to-World 행렬의 역행렬일 뿐이다.</p>
                <img data-src="./imgs/world_to_camera.png" alt="world_to_camera_matrix" class="r-stretch">
            </section>

        </div>
    </div>

    <!-- reveal.js의 핵심 JS 파일들을 지정된 경로에서 가져온다. -->
    <script src="../../reveal.js/dist/reveal.js"></script>
    <!-- 플러그인 로드 -->
    <script src="../../reveal.js/plugin/notes/notes.js"></script>
    <script src="../../reveal.js/plugin/markdown/markdown.js"></script>
    <script src="../../reveal.js/plugin/highlight/highlight.js"></script>
    <script src="../../reveal.js/plugin/math/math.js"></script>
    <script>
        // Reveal.js 초기화 및 플러그인 활성화
        Reveal.initialize({
            hash: true,
            plugins: [ RevealMarkdown, RevealHighlight, RevealNotes, RevealMath.KaTeX ]
        });
    </script>
</body>
</html>